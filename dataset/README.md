# JSONL 데이터 필터링 및 전처리

이 프로젝트는 JSONL 데이터셋에서 다음과 같은 기준에 따라 데이터를 필터링하고, 저장 시 텍스트 후처리를 수행합니다.

---

## 필터링 기준

1. **해시태그 포함 데이터 제거**
   - `content` 또는 `transformed_content` 필드에 `#`으로 시작하는 해시태그가 하나라도 포함된 경우 해당 데이터를 제거합니다.

2. **이모티콘 과다 사용 데이터 제거**
   - `content` 또는 `transformed_content` 필드에 이모티콘(유니코드 범위 내)이 3개 이상 포함된 경우 해당 데이터를 제거합니다.

3. **이모티콘 연속 사용 데이터 제거**
   - `content` 또는 `transformed_content` 필드에 이모티콘이 연속적으로 3개 이상 등장하는 경우 해당 데이터를 제거합니다.

4. **문자가 아닌 것으로 시작하는 데이터 제거**
   - `content` 또는 `transformed_content` 필드의 값이 한글 또는 영문 대소문자가 아닌 문자(특수문자, 이모티콘, 숫자 등)로 시작하는 경우 해당 데이터를 제거합니다.

5. **변환 텍스트 길이 비율 기준**
   - `transformed_content`의 길이가 `content`의 1.5배를 초과하는 경우 해당 데이터를 제거합니다.

---

## 저장 시 후처리

- 최종적으로 파일에 저장하기 전에, `content`와 `transformed_content` 필드의 텍스트에서 아래의 모든 줄바꿈 문자를 제거합니다.
  - 이스케이프된 줄바꿈: `\\r`, `\\n`, `\\r\\n`
  - 실제 줄바꿈 문자: `\r`, `\n`

---

## 사용 방법

1. 필터링할 JSONL 파일을 준비합니다.
2. 아래와 같이 필터링 스크립트를 실행합니다.

```bash
python preprocessing.py
```

3. 필터링 및 후처리된 데이터는 `filtered_dataset.jsonl`로 저장됩니다.

---

## 예시

### 입력 데이터 예시

```json
{"content": "#내돈내산 오늘은 고기를 먹었다!", "transformed_content": "🐶🐶🐶🐶🐶 오늘은 정말 맛있는 고기를 먹었다!"}
{"content": "🐾🐾🐾 오늘은 고기를 먹었다!", "transformed_content": "오늘은 정말 맛있는 고기를 먹었다!"}
{"content": "오늘은 고기를 먹었다!\\r\\n\\r\\n", "transformed_content": "오늘은 정말 맛있는 고기를 먹었다!\\r\\n"}
{"content": "오늘은 고기를 먹었다!", "transformed_content": "오늘은 정말 맛있는 고기를 먹었다!"}
```

### 필터링 및 후처리 후 데이터 예시

```json
{"content": "오늘은 고기를 먹었다!", "transformed_content": "오늘은 정말 맛있는 고기를 먹었다!"}
```

---

## 코드 주요 내용

- 각 조건별로 독립적인 함수로 구현되어 있어, 필요에 따라 개별적으로 조건을 추가/수정할 수 있습니다.
- 필터링 기준에 하나라도 해당되면 해당 데이터 전체가 제거됩니다.
- 데이터셋의 구조(필드)는 그대로 유지됩니다.
- 저장 직전에 content, transformed_content의 모든 줄바꿈 문자(`\\r`, `\\n`, `\\r\\n`, `\r`, `\n`)가 제거됩니다.

---

필터링 기준이나 코드에 대한 문의는 언제든 환영합니다.